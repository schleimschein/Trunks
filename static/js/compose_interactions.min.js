(function(){var postForm=document.getElementById("post-form");var postFormTitle=document.getElementById("post-form-title");var postFormTags=document.getElementById("post-form-tags");var postFormPublishSwitch=document.getElementById("post-form-publish-switch");var postFormPublishSwitchLabel=document.getElementById("post-form-publish-switch-label");var postFormSubmitButton=document.getElementById("post-form-submit-button");var postPreview=document.getElementById("preview");var postPreviewBox=document.getElementById("preview-box");var postPreviewHeading=document.getElementsByClassName("post-heading")[0];var postPreviewContent=document.getElementsByClassName("post-content")[0];var postPreviewTags=document.getElementsByClassName("post-tags")[0];(function(){var clickHandler=function(){postFormPublishSwitch.checked=false;postForm.submit()};var anchor=document.getElementById("action-draft");anchor.addEventListener("click",clickHandler,false)})();(function(){var clickHandler=function(){var postFormData={};postFormData.title=postFormTitle.value.trim();postFormData.content_markdown=postFormEditor.value();postFormData.tags=JSON.parse(postFormTags.value);var url="/admin/preview";var httpRequest=new XMLHttpRequest;httpRequest.open("POST",url);httpRequest.setRequestHeader("Content-Type","application/json");httpRequest.onload=function(){var postPreviewContent_html=JSON.parse(httpRequest.response)["html"];postPreviewHeading.innerHTML=postFormData.title;postPreviewContent.innerHTML=postPreviewContent_html;for(var i=0;i<postFormData.tags.length;i++){var postPreviewTag_html='<a class="level-item tag is-primary post-tag">'+postFormData.tags[i]["value"]+"</a>";postPreviewTags.insertAdjacentHTML("beforeend",postPreviewTag_html)}postPreview.style.display="block";postPreview.scrollIntoView()};httpRequest.onerror=function(){alert("Request contained an error")};httpRequest.send(JSON.stringify(postFormData))};var anchor=document.getElementById("action-preview");anchor.addEventListener("click",clickHandler,false)})();(function(){var clickHandler=function(){var editId=document.getElementsByName("post-edit-id")[0];if(typeof editId!=="undefined"&&editId!=null){editId=editId.value.trim();if(confirm("Are you sure you want to delete post "+editId+"?")){var url="/admin/posts/delete";var data=JSON.stringify({id:editId,was_edit:true});var httpRequest=new XMLHttpRequest;httpRequest.open("POST",url);httpRequest.setRequestHeader("Content-Type","application/json");httpRequest.onload=function(){if(JSON.parse(httpRequest.response)["ok"]===true){window.location="/admin/posts"}else{location.reload(true)}};httpRequest.onerror=function(){alert("Delete request contained an error")};httpRequest.send(data)}}else{window.location="/admin/posts"}};var anchor=document.getElementById("action-delete-post");anchor.addEventListener("click",clickHandler,false)})();(function(){var clickHandler=function(){postFormSubmitButton.innerHTML=postFormPublishSwitch.checked?"Post":"Save";postFormPublishSwitchLabel.innerHTML=postFormPublishSwitch.checked?"Publish":"Draft"};var anchor=document.getElementById("post-form-publish-switch");anchor.addEventListener("click",clickHandler,false)})()})();